# ecode

## Code 设计规范
Code 代码从 1001001 开始，10000 以下为保留 code.

错误代码说明：1001001
+ 10: 业务
+ 01: 服务
+ 001: 模块下的错误码序号，每个模块可以注册 1000 个错误


> **通用** - 所有服务都适用的错误，提高复用性，避免重复造轮子

## 错误描述规范

错误描述包括：对外的错误描述和对内的错误描述两部分。

### 对外的错误描述

- 对外暴露的错误说明，应该是 `该怎么做` 而不是 `哪里错了`

### 对内的错误描述

- 对内暴露的错误，统一大写开头，结尾不要加`.`
- 对内暴露的错误，要简洁，并能准确说明问题

> 对外错误信息是直接暴露给用户的，不能包含敏感信息

## 错误记录规范

在错误产生的最原始位置调用日志，打印错误信息，其它位置直接返回。

当错误发生时，调用log包打印错误，通过log包的caller功能，可以定位到log语句的位置，也即能够定位到错误发生的位置。当使用这种方式来打印日志时，需要中遵循以下规范：

- 只在错误产生的最初位置打印日志，其它地方直接返回错误，不需要再对错误进行封装。
- 当代码调用第三方包的函数时，第三方包函数出错时，打印错误信息。比如：

```go
if err := os.Chdir("/root"); err != nil {
    log.Errorf("change directory failed: %v", err)
}
```
